{% load staticfiles %}

<html>
<head>


    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>



    <link href="/static/style.css?ver=2" rel="stylesheet" type="text/css"/>
    <link href="/static/dht_style.css?ver=1" rel="stylesheet" type="text/css"/>
    <link href="/static/style-responsive.css" rel="stylesheet" type="text/css" media="screen"/>
    <link href="/static/css/font-awesome.css" rel="stylesheet" type="text/css"/>
    <!--<link rel="stylesheet" href="css/bootstrap.min.css">-->


    <title>DHT11 Temperature/Humidity monitoring</title>

</head>

<body mode="desktop" num="2000">


{% block container %}
    <div class="header">
        <div class="container">
            <div class="main">
                <a href="#" class="logo"><img src="/static/images/logo.png" alt="" width="300" , height="50"/></a>
            </div>


            <div class="nav mobile">
                <!--                    <div class="title">Menu <slogo2.pngpan class="fa "></slogo2.pngpan></div>-->
                <ul>
                    <li><a href="#team">Team</a></li>
                    <li><a href="#features">FEATURES</a></li>
                    <li><a href="model">Hardware Modeling </a></li>
                    <li><a href="real">Real Time data</a></li>
                    <li><a href="history">data history</a></li>
                </ul>
            </div>
            <div class="nav mobile2">
                <ul>
                    <li><a href="#subscribe_part">Sign in</a></li>
                    <li><a href="#subscribe_part">Sign Up</a></li>
                </ul>
            </div>


        </div>
    </div>
    <div id="temp" class="mini">
        <h6 id="temp_text">24</h6>
        <p>Temperature</p>
    </div>
    <div id="humi" class="mini">
        <h6 id="humi_text">36</h6>
        <p>Temperature</p>
    </div>
    <div id="elec" class="mini">
        <h6 id="elec_text">2234</h6>
        <p>electronic</p>
    </div>
    <div id="infra" class="mini">
        <h6 id="infra_text">24123</h6>
        <p>infrared</p>
    </div>

    <div class="info">
        <div class="card-1">
            <p id="op_id">Operator ID</p>
            <div id="operator-led">
                <p>2353</p>
            </div>
        </div>
        <div class="card-2">
            <p id="outlier">Recent Outlier data</p>
            <div id="outlier_table">
                <table class="tg">
                    <tr>
                        <th class="tg-il3a">Sensor</th>
                        <th class="tg-il3a">Time</th>
                        <th class="tg-il3a">value</th>
                    </tr>
                    <tr>
                        <td class="tg-il3a"></td>
                        <td class="tg-il3a"></td>
                        <td class="tg-il3a"></td>
                    </tr>
                    <tr>
                        <td class="tg-il3a"></td>
                        <td class="tg-il3a"></td>
                        <td class="tg-il3a"></td>
                    </tr>
                    <tr>
                        <td class="tg-il3a"></td>
                        <td class="tg-il3a"></td>
                        <td class="tg-il3a"></td>
                    </tr>
                </table>
            </div>
        </div>
        <div id="bt_div">
            <button id="start_bt">start</button>
        </div>
        <div>

        </div>

    </div>


    <div id="chart">
        <script>
            var data = getData()
            var time = new Date()


            Plotly.plot('chart', [
                {
                    x: [time],
                    y: [data['temp']],
                    mode: 'lines',
                    marker: {color: 'pink', size: 8},
                    line: {width: 4},
                    name: 'Temperature'
                }, {
                    x: [data['time']],
                    y: [data['humi']],
                    mode: 'lines',
                    marker: {color: 'gray', size: 8},
                    line: {width: 4},
                    name: 'Humidity'
                },
            ]);
            var cnt = 0;

            var interval = setInterval(function () {
                var data = getData();
                var time = new Date();
                Plotly.extendTraces('chart', {
                    x: [[time], [time]],
                    y: [[data['temp']], [data['humi']]]
                }, [0, 1])


            }, 1000);


            function getData() {
                var jsonData = new Object();
                $.ajax({
                    url: 'arduino/',
                    datatype: 'json',
                    async: false,
                    type: 'GET',
                    data: "{}",
                    beforeSend: function (XMLHttpRequest) {
                    },
                    success: function (data) {
                        jsonData.temp = data['temperature']
                        jsonData.humi = data['humi']
                        jsonData.date = data['date']
                        jsonData.time = data['time']
                    },
                    error: function (request, status, error) {
                        alert("실패")
                    }
                });
                return jsonData
            }
        </script>
    </div>

    <div id="chart1"></div>



{% endblock %}
</body>
</html>