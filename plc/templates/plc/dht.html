{% load staticfiles %}
<html>
  <head>
      <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <!-- TITLE -->
        <title>PLC - Data Modeling</title>

        <!-- Main StyleSheet -->
        <link href="/static/style.css?ver=5" rel="stylesheet" type="text/css" />
        <link href="/static/style-responsive.css" rel="stylesheet" type="text/css" media="screen" />
        <link href="/static/css/font-awesome.css" rel="stylesheet" type="text/css" />
        <!--<link rel="stylesheet" href="css/bootstrap.min.css">-->
        <link rel="stylesheet" href="css/libs/animate.css">


		<!-- bxSlider CSS file -->
        <link href="/static/css/jquery.bxslider.css" rel="stylesheet" />


        <!-- LayerSlider stylesheet -->
        <link rel="stylesheet" href="/static/layerslider/css/layerslider.css" type="text/css">
        <!-- External libraries: jQuery & GreenSock -->
        <script src="/static/layerslider/js/jquery.js" type="text/javascript"></script>
        <script src="/static/layerslider/js/greensock.js" type="text/javascript"></script>
        <!-- LayerSlider script files -->
        <script src="/static/layerslider/js/layerslider.transitions.js" type="text/javascript"></script>
        <script src="/static/layerslider/js/layerslider.kreaturamedia.jquery.js" type="text/javascript"></script>

        <script src="/static/js/bootstrap.min.js" type="text/javascript"></script>


		<!-- bxSlider Javascript file -->
        <script src="/static/js/jquery.bxslider.js"></script>
        <script>
		$(document).ready(function(){
		$('.bxslider').bxSlider({

								pager: false,
								controls: true,
								auto: true


								});
		});
		</script>



		<link rel="stylesheet" type="text/css" href="/static/lightbox/jquery.fancybox.css" media="screen" />
		<link rel="stylesheet" type="text/css" href="/static/lightbox/jquery.fancybox.css" media="screen" />
		<script src="/static/lightbox/jquery.fancybox.js"></script>
        <script type="text/javascript">
                $(document).ready(function() {

                    $('.fancybox').fancybox();

                });
        </script>


        <!-- GOTO TOP JQUERY -->
        <script type="text/javascript">
        $(function() {
            $(window).scroll(function() {
                if($(this).scrollTop() != 0) {
                    $('#gotop').fadeIn();
                } else {
                    $('#gotop').fadeOut();
                }
            });

            $('#gotop').click(function() {
                $('body,html').animate({scrollTop:0},800);
            });
        });
        </script>



		<!-- HEADER JQUERY -->
        <script type="text/javascript">
        $(function() {
            $(window).scroll(function() {
                if($(this).scrollTop() >= 200) {
                    $('.header').addClass("header_fix");
                } else {
                   $('.header').removeClass("header_fix");
                }
            });
        });
        </script>


        <script type="text/javascript">

		if($(window).width() <= 900){
		$(document).ready(function() {



                    $('.mobile .title').click(function() {

												$(this).next("ul").slideToggle();
												$(this).toggleClass("minus");

												});



                });

		}
        </script>

      <script src="https://d3js.org/d3.v4.min.js"></script>
       <script src="http://code.jquery.com/jquery-latest.min.js"></script>

        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
      <style>
         body {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }


    #chart {
        position:relative;
    }
      </style>
    <title>DHT11 Temperature/Humidity monitoring</title>
  </head>

  <body mode="desktop" num="2000">
    <div class="header">
        <div class="container" >
            <div class = "main">
                <a href="#" class="logo"><img src="/static/images/logo2.png" alt="" width="300", height="50"/></a>
            </div>


                    <div class="nav mobile" >
<!--                    <div class="title">Menu <slogo2.pngpan class="fa "></slogo2.pngpan></div>-->
                    <ul>
                    <li><a href="#team">Team</a></li>
                    <li><a href="#features">FEATURES</a></li>
                    <li><a href="model">Hardware Modeling </a></li>
                    <li><a href="real">Real Time data</a></li>
                    <li><a href="history">data history</a></li>
                    </ul>
                    </div>
              <div class="nav mobile2">
                  <ul>
                        <li><a href="#subscribe_part">Sign in</a></li>
                    </ul>
                    </div>


        </div>
        </div>

    {% block content %}
    <div id="chart"></div>
        <script>
              var data = getData()
      var time = new Date()


     Plotly.plot('chart', [
     {
    x:[time],
  y: [data['temp']],
  mode: 'lines',
  marker: {color: 'pink', size: 8},
  line: {width: 4},
  name:'Temperature'
}, {
         x:[data['time']],
  y: [data['humi']],
  mode: 'lines',
  marker: {color: 'gray', size:8},
  line: {width: 4},
  name:'Humidity'
}]);
      var cnt =0;

    var interval = setInterval(function() {
        var data = getData();
        var time = new Date();
     Plotly.extendTraces('chart', {
          x: [[time], [time]],
          y: [[data['temp']], [data['humi']]]
    }, [0, 1])


     cnt = cnt+1;
     console.log(cnt)
 // if(cnt === 100) clearInterval(interval);

}, 1000);



        function getData() {
              var jsonData = new Object();
               $.ajax({
                  url: 'arduino/',
                  datatype: 'json',
                  async: false,
                  type: 'GET',
                  data: "{}",
                  beforeSend: function(XMLHttpRequest){},
                  success: function (data) {
                      jsonData.temp = data['temperature']
                      jsonData.humi = data['humi']
                      jsonData.date = data['date']
                      jsonData.time = data['time']
                  },
                  error: function (request, status, error) {
                      alert("실패")
                  }
              });
               return jsonData
          }
        </script>
  {% endblock %}
  </body>
</html>