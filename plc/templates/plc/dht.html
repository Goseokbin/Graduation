{% load staticfiles %}

<html>
  <head>

        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <link href="/static/style.css?ver=1" rel="stylesheet" type="text/css" />
        <link href="/static/style-responsive.css" rel="stylesheet" type="text/css" media="screen" />
        <link href="/static/css/font-awesome.css" rel="stylesheet" type="text/css" />
        <!--<link rel="stylesheet" href="css/bootstrap.min.css">-->
        <link rel="stylesheet" href="css/libs/animate.css">
      <style>
         body {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
         @font-face {
             font-family: 'led';
             src:url("/static/fonts/led_board-7.ttf")format("truetype");
         }


    #chart {
    float: left;
    height : 500;
    width :60%;
    background-color: ivory;

    }
      #chart1 {
    float: left;
    height : 500;
    width :60%;

    }
      .mini{

          display: inline-block;
          float : left;
          width: 200;
          height:100;
          text-align : center;
          margin : 30;
          padding: 10;
          box-shadow: 1px 2px 3px 0.5px gray;
      }
      .mini div{
          margin : 30;
          padding: 10;
      }
      .mini h6{
          margin : 10;
          padding: 10;
      }

    .info{
       background-color :#187CC2;
       float: right;
       width: 40%;
       height:1000;
    }
          #card-1{
              display:flex;
              flex-direction: column;
              justify-content: space-evenly;
              widht: 100%;
              margin-bottom: 3rem;
              margin:50;
              text-align:center
          }
          #op_id{
              margin: 2rem;
              color: inherit;
              font-size:20px;
          }
          #operator-led{
              width: 160;
              height:120;
              margin-left:250;
              border: 1px solid;
          }
          #operator-led > div{
              width:80%;


          }
          #operator-led > h6{
              margin-top: 30;
          }
          #operator-led > p{
              font-size: 50px;
              font-family: led;
              margin-top: 40;
          }
      </style>
    <title>DHT11 Temperature/Humidity monitoring</title>
  </head>

  <body mode="desktop" num="2000">


  {% block container %}
   <div class="header">
        <div class="container" >
            <div class = "main">
                <a href="#" class="logo"><img src="/static/images/logo2.png" alt="" width="300", height="50"/></a>
            </div>


                    <div class="nav mobile" >
<!--                    <div class="title">Menu <slogo2.pngpan class="fa "></slogo2.pngpan></div>-->
                    <ul>
                    <li><a href="#team">Team</a></li>
                    <li><a href="#features">FEATURES</a></li>
                    <li><a href="model">Hardware Modeling </a></li>
                    <li><a href="real">Real Time data</a></li>
                    <li><a href="history">data history</a></li>
                    </ul>
                    </div>
              <div class="nav mobile2">
                  <ul>
                        <li><a href="#subscribe_part">Sign in</a></li>
                        <li><a href="#subscribe_part">Sign Up</a></li>
                    </ul>
                    </div>


        </div>
        </div>
      <div id = "temp" class = "mini">
      <h6 id = "temp_text">24</h6>
      <p>Temperature</p>
      </div>
      <div id = "humi" class = "mini">
      <h6 id = "humi_text">36</h6>
      <p>Temperature</p>
      </div>
      <div id = "elec" class = "mini">
      <h6 id = "elec_text">2234</h6>
      <p>electronic</p>
      </div>
      <div id = "infra" class = "mini">
      <h6 id = "infra_text">24123</h6>
      <p>infrared</p>
      </div>
    <div class = "info">
    <div id = "card-1">
        <p id="op_id">Operator ID</p>
        <div id = "operator-led">
            <p>2353</p>
        </div>
    </div>

    </div>
  <div id="chart">
              <script>
      var data = getData()
      var time = new Date()


     Plotly.plot('chart', [
     {
    x:[time],
  y: [data['temp']],
  mode: 'lines',
  marker: {color: 'pink', size: 8},
  line: {width: 4},
  name:'Temperature'
}, {
         x:[data['time']],
  y: [data['humi']],
  mode: 'lines',
  marker: {color: 'gray', size:8},
  line: {width: 4},
  name:'Humidity'
}]);
      var cnt =0;

    var interval = setInterval(function() {
        var data = getData();
        var time = new Date();
     Plotly.extendTraces('chart', {
          x: [[time], [time]],
          y: [[data['temp']], [data['humi']]]
    }, [0, 1])


     cnt = cnt+1;
     console.log(cnt)
 // if(cnt === 100) clearInterval(interval);

}, 1000);



        function getData() {
              var jsonData = new Object();
               $.ajax({
                  url: 'arduino/',
                  datatype: 'json',
                  async: false,
                  type: 'GET',
                  data: "{}",
                  beforeSend: function(XMLHttpRequest){},
                  success: function (data) {
                      jsonData.temp = data['temperature']
                      jsonData.humi = data['humi']
                      jsonData.date = data['date']
                      jsonData.time = data['time']
                  },
                  error: function (request, status, error) {
                      alert("실패")
                  }
              });
               return jsonData
          }
        </script>
  </div>

        <div id="chart1"></div>



   {% endblock %}
  </body>
</html>